<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{ecommerce/layout}">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title></title>
</head>
<body>
	<div layout:fragment="content">
		<div class="row">
			<div class="col-lg-2">
				<nav>
					<ul class="nav nav-pill">
						<li class="nav-item"><a class="nav-link active"
							href="/admin/clientes/consultar">
							<i class="fas fa-search"></i>
							Pesquisar clientes</a></li>
					</ul>
				</nav>
			</div>
			<div class="col-10">
				<div class="row">
					<div class="col-lg-12">
						<ul class="nav nav-tabs">
							<li class="nav-item">
								<a href="#" class="nav-link"
									id="btntab-dados" 
									v-on:click="setTab('A')"
									v-bind:class="{active:isActive('A')}"
									>Dados Gerais</a>
							</li>
							<li class="nav-item">
								<a href="#" class="nav-link"
									id="btntab-endereco" 
									v-on:click="setTab('B')"
									v-bind:class="{active:isActive('B')}"
									>Endereços</a>
							</li>
							<li class="nav-item">
								<a href="#" class="nav-link"
									id="btntab-cartoes" 
									v-on:click="setTab('C')"
									v-bind:class="{active:isActive('C')}"
									>Cartoes</a>
							</li>
						</ul>
					</div>
					<div class="col-lg-12">
						<div class="alert alert-warning" th:if="${resultado != null && resultado.msg != null}">
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
		    					<span aria-hidden="true">&times;</span>
		  					</button>
							<span th:utext="${resultado.msg}"></span>
						</div>
						<form th:action="${cliente.id} == 0 ?  @{/admin/cliente/salvar} : @{/admin/cliente/salvar}" 
							  th:object="${cliente}" method="post" id="frmCliente">
							<div v-show="selectedDiv === 'A'">
								<div class="form-row">
									<div class="form-group col-md-4">
										<label>Nome:</label>
										<input type="text" class="form-control" th:field="*{nome}" />
									</div>
									<div class="form-group col-md-4">
										<label>Data Nascimento</label>
										<input type="date" class="form-control" th:field="*{dataNascimento}" />
									</div>
									<div class="form-group col-md-4">
										<label>CPF:</label>
										<input type="text" class="form-control" th:field="*{cpf}" />
									</div>
								</div>
								<div class="form-row">
									<div class="form-group col-md-4">
										<label>Email:</label>
										<input type="text" class="form-control" th:field="*{usuario.email}" th:attrappend="readonly=${cliente.id != 0}?'readonly'" />
									</div>
									<div class="form-group col-md-4" th:if="${cliente.id == 0}">
										<label>Senha </label>
										<input type="password" class="form-control" th:field="*{usuario.password}" />
									</div>
									<div class="form-group col-md-4" th:if="${cliente.id == 0}">
										<label>Confirmar Senha:</label>
										<input type="password" class="form-control" th:field="*{usuario.confirmaPassword}"
												 />
									</div>
								</div>
								<div class="form-row">
									<div class="form-group col-md-4">
										<label>DDD:</label>
										<input type="text" class="form-control" th:field="*{telefone.ddd}" maxlength="3"/>
									</div>
									<div class="form-group col-md-4">
										<label>Numero Telefone:</label>
										<input type="text" class="form-control" th:field="*{telefone.numero}" />
									</div>
									<div class="form-group col-md-4">
										<label>Tipo telefone:</label>
										<select th:field="*{telefone.tipo}" class="form-control">
											<option th:each="state: ${T(com.les.ecommerce.model.cliente.TipoTelefone).values()} "
												th:value="${state}"
												th:text="${state.value()}">
											</option>
										</select>
									</div>
								</div>
								<div class="form-row">
									<div class="form-group col-md-4">
										<label>Gênero:</label>
										<div class="form-check" th:each="state: ${T(com.les.ecommerce.model.cliente.Genero).values()}">
											<input type="radio" th:field="*{genero}" th:value="${state}" class="form-check-input"/>
											<label th:text="${state}" class="form-check-label" 
												   th:for="${#ids.prev('genero')}"></label>
										</div>
									</div>
								</div>
							</div>
							<div v-show="selectedDiv === 'B'">
								<div th:each="endereco, itemStat : *{enderecos}" style="border-bottom: 3px solid #ccc;margin-bottom:12px">
									<b th:text="'Endereço  - ' + ${itemStat.index + 1}"></b>
									<div class="form-row">
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.descricao'">Descrição</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].descricao}" required/>
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.tipoResidencia'">tipo residencia</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].tipoResidencia}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.tipoLogradouro'">Tipo Logradouro</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].tipoLogradouro}" />
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.numero'">Numero</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].numero}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.bairro'">Bairro</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].bairro}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.cep'">CEP</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].cep}" />
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.pais'">Pais</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].pais}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.estado'">Estado</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].estado}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'enderecos' + ${itemStat.index} + '.cidade'">Cidade</label>
											<input type="text" class="form-control" th:field="*{enderecos[__${itemStat.index}__].cidade}" />
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-12">
											<label th:for="'enderecos' + ${itemStat.index} + '.tipo'">Tipo endereco</label>
											<select class="form-control" th:field="*{enderecos[__${itemStat.index}__].tipo}">
												<option value="">Selecionar tipo</option>
												<option th:each="state: ${T(com.les.ecommerce.model.cliente.TipoEndereco).values()}"
														th:text="${state.value()}"
														th:value="${state}"></option>
											</select>
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-12">
											<button class="btn btn-danger" 
													type="button"
												th:attr="'@click'=${'removerEndereco(' + itemStat.index + ')'}"
												th:if="${cliente.enderecos.size() > 1}">
												Remover
											</button>
										</div>
									</div>
								</div>
							</div>
							<div v-show="selectedDiv === 'C'">
								<div th:each="cartao,itemStat: *{cartoes}" style="border-bottom:3px solid #ccc;margin-bottom:12px">
									<b th:text="'Cartão - ' + ${itemStat.index + 1}"></b>
									<div class="form-row">
										<div class="form-group col-md-4">
											<label th:for="'cartoes' + ${itemStat.index} + '.titular'">Titular</label>
											<input type="text" class="form-control" th:field="*{cartoes[__${itemStat.index}__].titular}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'cartoes' + ${cartaoIndex} + '.numero'">Numero</label>
											<input type="text" class="form-control" th:field="*{cartoes[__${itemStat.index}__].numero}" />
										</div>
										<div class="form-group col-md-4">
											<label th:for="'cartoes' + ${cartaoIndex} + '.codigoSeguranca'">Codigo Segurança</label>
											<input type="text" class="form-control" th:field="*{cartoes[__${itemStat.index}__].codigoSeguranca}" />
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-4">
											<label th:for="'cartoes' + ${itemStat.index} + '.bandeira'">Bandeira Cartão</label>
											<select th:field="*{cartoes[__${itemStat.index}__].bandeira}" class="form-control">
												<option th:each="state : ${T(com.les.ecommerce.model.cliente.BandeiraCartao).values()}"
														th:text="${state.value()}"
														th:value="${state}">
											</select>
										</div>
										<div class="form-group col-md-4">
											<label th:for="'cartoes' + ${itemStat.index} + '.validade'">Validade</label>
											<input type="date" th:field="*{cartoes[__${itemStat.index}__].validade}" class="form-control" />
										</div>
									</div>
									<div class="form-row">
										<div class="form-group col-md-12">
											<button class="btn btn-danger"
													type="button"
													th:attr="'@click'=${'removerCartao(' + itemStat.index + ')'}"
													th:if="${cliente.cartoes.size() > 1}">
													Remover		
											</button>
										</div>
									</div>
								</div>
							</div>
							<button class="btn btn-primary"  id="btnSalvarCliente" type="button" @click="salvarCliente" th:if="${cliente.id ==0}">
								Salvar Cliente
							</button>
							<button class="btn btn-success" id="btnEditarCliente" type="button" @click="editarCliente" th:if="${cliente.id != 0}">
								Salvar Cliente
							</button>
							<button type="button" id="btnAddEndereco" class="btn btn-success" @click="addEndereco" v-if="selectedDiv == 'B'">
								Adicionar endereço
							</button>
							<button type="button" id="btnAddCartao" class="btn btn-success" @click="addCartao" v-if="selectedDiv == 'C'">
								Adicionar cartão
							</button>
							<input type="hidden" name="action" :value="action"  id="action"/>
							<input type="hidden" th:field="*{id}" />
							<input type="hidden" th:field="*{usuario.id}" />
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<th:block layout:fragment="scriptblock">
		<script data-main="/js/cliente/cadastrar"
			src="/webjars/requirejs/require.min.js"></script>
	</th:block>
</body>
</html>