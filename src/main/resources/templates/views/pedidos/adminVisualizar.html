<!DOCTYPE html>
<html lang="en" 
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{ecommerce/layout}">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
</head>
<body>
    <div layout:fragment="content">
    <form th:action="@{/admin/pedidos/alterarStatus}" th:object="${pedido}" method="post" id="frmPedido">
    	<div class="row">
    		<div class="col-lg-12">
	    		<div class="alert alert-warning" th:if="${resultado != null && resultado.msg != null}">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close">
    					<span aria-hidden="true">&times;</span>
  					</button>
					<span th:utext="${resultado.msg}"></span>
				</div>
    			<div class="card">
   					<div class="card-header">
   						<h2>Pedido número: <span th:text="${#numbers.formatInteger(pedido.id,8)}"></span>
   							(<span th:text="${pedido.statusPedido.value()}"></span>)
   						</h2>
   					</div>
   					<div class="card-body">
   						<div class="row">
   							<div class="col-lg-3">
   								<div class="card">
	    							<div class="card-body">
	    								<h5>Informações da entrega</h5>
	    								<div class="card-text">
	    									<div style="text-transform:capitalize;">
		    									<p>
			    									<b>Endereco : </b> 
			    									<span th:text="${pedido.enderecoEntrega.tipoLogradouro}"></span>
			    									<span th:text="${pedido.enderecoEntrega.descricao}"></span>
		    									<p>
		    									<p><b>Numero: </b><span th:text="${pedido.enderecoEntrega.numero}"></span></p>
	    										<p><b>CEP: </b><span th:text="${pedido.enderecoEntrega.cep}"></span></p>
	    									</div>
	    									<div style="text-transform: capitalize;">
	    										
	    									</div>
	    								</div>
	    							</div>
   								</div>
   							</div>
   							<div class="col-lg-3" th:each="cartao : ${pedido.cartao}">
   								<div class="card">
   									<div class="card-header">
   										<h5>Cartão - <span th:text="${cartao.titular}"></span> </h5>
   									</div>
   									<div class="card-body">
   										<div class="card-text">
   											<p>
   												<b>Numero: </b> <span th:text="${cartao.numero}"></span>
   											</p>
   											<p>
   												<b>Valor: </b> <span th:text="${cartao.valorUtilizado}"></span>
   											</p>
   											<p>
   												<b>Validade: </b><span th:text="${#temporals.format(cartao.validade,'dd/MM/yyyy')}"></span>
   											</p>
   										</div>
   									</div>
   								</div>
   							</div>
   						</div>
   					</div>
   					<div class="card-body">
   						<div class="row">
   							<div class="col-lg-12">
   								<table class="table table-dark">
   									<caption>Produtos</caption>
   									<thead>
   										<tr>
   											<th>#</th>
   											<th>Descricao</th>
   											<th>Quantidade</th>
   											<th></th>
   										</tr>
   									</thead>
   									<tbody>
   										<tr th:each="item , state: ${pedido.itens}">
   											<td th:text="${#numbers.formatInteger(item.produto.id,10)}"></td>
   											<td th:text="${item.produto.descricao}"></td>
   											<td th:text="${item.quantidade}"></td>
   											<td th:if="${pedido.statusPedido == T(com.les.ecommerce.model.venda.StatusPedido).TROCA_AUTORIZADA}">
   												<input type="hidden" th:name="|itensRetorno[${state.index}].produto.id|" 
   													th:value="${item.produto.id}" />
   												<input type="number" th:name="|itensRetorno[${state.index}].quantidade|" />
   											</td>
   										</tr>
   									</tbody>
   								</table>
   							</div>
   						</div>
   					</div>
   					<div class="card-footer">
   							<input type="hidden" th:field="*{id}"/>
   							<input type="hidden" th:field="*{statusPedido}" />
   							<button class="btn btn-success" id="btnDespachar" type="button"
   							th:if="${pedido.statusPedido == T(com.les.ecommerce.model.venda.StatusPedido).APROVADO }">Despachar</button>
   							<button class="btn btn-success" id="btnAutorizarTroca" type="button"
   								th:if="${pedido.statusPedido == T(com.les.ecommerce.model.venda.StatusPedido).EMTROCA }">Autorizar Troca</button>
   								<button class="btn btn-success" id="btnEntregar" type="button"
   							th:if="${pedido.statusPedido == T(com.les.ecommerce.model.venda.StatusPedido).TRANSITO }">Entregue</button>
   							<button class="btn btn-success" id="btnRecebimento" type="button"
   							th:if="${pedido.statusPedido == T(com.les.ecommerce.model.venda.StatusPedido).TROCA_AUTORIZADA }">Confirmar recebimento</button>
   						
   					</div>
    			</div>
    		</div>
    	</div>
    	</form>
    </div>
    <th:block layout:fragment="scriptblock">
		<script data-main="/js/pedidos/adminVisualizarPedido"
			src="/webjars/requirejs/require.min.js"></script>
	</th:block>
</body>
</html>